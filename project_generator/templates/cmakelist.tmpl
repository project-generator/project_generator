#
# Copyright (c) 2015 0xc0170
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# This project was exported via the project generator.  More information https://github.com/project-generator/project_generator

cmake_minimum_required (VERSION 3.0)
project ({{name}})
# project ({{project}} C CXX ASM)

INCLUDE(CMakeForceCompiler)

SET(CMAKE_SYSTEM_NAME Generic)
set(CMAKE_SYSTEM_PROCESSOR {{core}})
CMAKE_FORCE_C_COMPILER(arm-none-eabi-gcc GNU)
CMAKE_FORCE_CXX_COMPILER(arm-none-eabi-g++ GNU)

{% for symbol in macros %}
set(DEFINES "${DEFINES} -D{{symbol}}"){% endfor %}

{% for path in includes %}
include_directories("${ {{path}} }"){% endfor %}

{% for library in libraries %}
set(LIBRARIES {{library}}){% endfor %}

{% for path in lib_paths %}
link_directories({{path}}){% endfor %}

{% for file in source_files_c %}
set(SOURCES {{file}}){% endfor %}
{% for file in source_files_cpp %}
set(SOURCES {{file}}){% endfor %}
{% for file in source_files_s %}
set(SOURCES {{file}}){% endfor %}

{% for file in source_files_obj %}
set(OBJECTS {{file}}){% endfor %}

set(COMMON_FLAGS "{{cmake_common_flags}}")
set(CMAKE_CXX_FLAGS "${COMMON_FLAGS} ${DEFINES} {{cmake_cxx_flags}}")
set(CMAKE_C_FLAGS "${COMMON_FLAGS} ${DEFINES} {{cmake_c_flags}}")
set(CMAKE_EXE_LINKER_FLAGS "{{cmake_linker_flags}}")

set(CMAKE_EXE_LINKER_FLAGS "{{linker_options}}")
set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} \"-T{{linker_file}}\" -static")

set(EXECUTABLE_OUTPUT_PATH {{build_dir}})
# set(PROJECT_FOLDER {{name}})

# Lib or exe
# add_library
add_executable(${SOURCES} {% if source_files_obj %} ${OBJECTS} {% endif %})
target_link_libraries(${ {{name}} } ${LIBRARIES})
